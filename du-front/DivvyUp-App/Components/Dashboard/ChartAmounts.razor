@using System.Globalization
@using DivvyUp_Shared.Interface
@using DivvyUp_Shared.Model

<RadzenStack Style="width: 100%; height: 100%;">
    <RadzenRow>
        <RadzenColumn Size="4">
            <RadzenChart Style="height: 130%">
                <RadzenPieSeries Data="@ChartUnpaidAmount" Title="Aktualny bilans" CategoryProperty="@nameof(ChartData.Name)" ValueProperty="@nameof(ChartData.Value)">
                    <RadzenSeriesDataLabels Visible="false" />
                    <RadzenLegend Visible="false" />
                    <RadzenValueAxis Formatter="@Format">
                        <RadzenGridLines Visible="true" />
                    </RadzenValueAxis>
                </RadzenPieSeries>
            </RadzenChart>
        </RadzenColumn>
        <RadzenColumn Size="8">
            <RadzenChart Style="height: 130%">
                <RadzenPieSeries Data="@ChartTotalAmount" Title="Łączny wydatek" CategoryProperty="@nameof(ChartData.Name)" ValueProperty="@nameof(ChartData.Value)">
                    <RadzenSeriesDataLabels Visible="false" />
                    <RadzenLegend Visible="true"/>
                    <RadzenValueAxis Formatter="@Format">
                        <RadzenGridLines Visible="true" />
                    </RadzenValueAxis>
                </RadzenPieSeries>
            </RadzenChart>
        </RadzenColumn>
    </RadzenRow>
</RadzenStack>

<style>
    .rz-chart-tooltip {
        z-index: 1000;
    }
 </style>

@code {
    [Inject]
    private IChartService ChartService { get; set; }

    private List<ChartData> ChartUnpaidAmount { get; set; }
    private List<ChartData> ChartTotalAmount { get; set; }

    protected override async Task OnInitializedAsync()
    {
        ChartUnpaidAmount = await ChartService.GetUnpaindAmounts();
        ChartTotalAmount = await ChartService.GetTotalAmounts();
    }

    string Format(object value)
    {
        return ((double)value).ToString("C0", CultureInfo.CreateSpecificCulture("pl-PL"));
    }
}
