@using DivvyUp_Shared.Interface
@using DivvyUp_Shared.Model

<RadzenStack Style="width: 100%; height: 100%;">
    <RadzenChart Style="height: 130%">
        <RadzenColumnSeries Data="@PercantageExpenses" Title="Procent rzetelności" FillRange="@ColorRanges" LineType="LineType.Dashed" CategoryProperty="@nameof(ChartData.Name)" ValueProperty="@nameof(ChartData.Value)">
            <RadzenSeriesDataLabels Visible="false" />
            <RadzenColumnOptions Radius="5" />
            <RadzenLegend Visible="false" />
            <RadzenValueAxis Formatter="@Format">
                <RadzenGridLines Visible="true" />
                @* <RadzenAxisTitle Text="Procent rozliczenia" /> *@
            </RadzenValueAxis>
        </RadzenColumnSeries>
    </RadzenChart>
</RadzenStack>

<style>
    .rz-chart-tooltip{
        z-index: 999 !important;
    }
 </style>

@code {
    [Inject]
    private IChartService ChartService { get; set; }

    private List<ChartData> PercantageExpenses { get; set; }
    private List<SeriesColorRange> ColorRanges = new List<SeriesColorRange>()
    {
        new SeriesColorRange() {Min = 0, Max = 30, Color = "red"},
        new SeriesColorRange() {Min = 30.01, Max = 89.99, Color = "orange"},
        new SeriesColorRange() {Min = 90, Max = 100, Color = "#06cd06"},
    };

    protected override async Task OnInitializedAsync()
    {
        PercantageExpenses = await ChartService.GetPercantageExpenses();
    }

    string Format(object value)
    {
        return $"{((double)value):N0}%";
    }
}
