@using DivvyUp_Web.Api.Response

<RadzenDataGrid AllowFiltering="true" AllowColumnResize="true" AllowAlternatingRows="false" FilterMode="FilterMode.Simple" AllowSorting="true" PageSize="5" AllowPaging="true" PagerHorizontalAlign="HorizontalAlign.Center" ShowPagingSummary="true"
                Data="@Receipts" ColumnWidth="300px" LogicalFilterOperator="LogicalFilterOperator.Or" @ref="receiptGrid">
    <HeaderTemplate>
        <RadzenButton ButtonStyle="ButtonStyle.Success" Icon="add_circle" Text="Dodaj rachunek" Click="@InsertRow"  />
    </HeaderTemplate>
    <Columns>
        <RadzenDataGridColumn Property="@nameof(ShowReceiptResponse.settled)" Title="Zarządzanie" Width="15%" TextAlign="TextAlign.Center" Filterable="false">
            <FilterTemplate>
                <RadzenButton ButtonStyle="ButtonStyle.Success" Icon="add_circle" Text="Dodaj rachunek" Click="@InsertRow" />
            </FilterTemplate>
            <Template Context="receipt">
                <RadzenCheckBox class="button" @bind-Value="receipt.settled" Change="@(async (bool Check) => await SetSettled(receipt.receiptId, receipt.settled))"/>
                <RadzenButton class="button" Icon="edit" ButtonStyle="ButtonStyle.Secondary" Click="@(args => EditRow(receipt))" />
                <RadzenButton class="button" Icon="delete" ButtonStyle="ButtonStyle.Danger" Click="@((args) => RemoveReceipt(receipt.receiptId))"/>
            </Template>
            <EditTemplate Context="receipt">
                <RadzenButton Icon="check" ButtonStyle="ButtonStyle.Success" Click="@((args) => AddReceipt(receipt))"/>
                <RadzenButton Icon="close" ButtonStyle="ButtonStyle.Danger" Click="@((args) => CancelEdit(receipt))"/>
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="@nameof(ShowReceiptResponse.receiptName)" Title="Nazwa" Frozen="true" Width="40%">
            <EditTemplate Context="receipt">
                <RadzenTextBox @bind-value="receipt.receiptName" Style="width: 100%;"/>
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="@nameof(ShowReceiptResponse.date)" Title="Data" Frozen="true" Width="25%" FilterMode="FilterMode.SimpleWithMenu">
            <Template Context="data">
                @data.date.ToString("dd.MM.yyyy")
            </Template>
            <EditTemplate Context="receipt">
                @{
                    if (receipt.date == default(DateTime))
                    {
                        receipt.date = DateTime.Now;
                    }
                }
                <RadzenDatePicker @bind-Value="receipt.date" ShowCalendarWeek DateFormat="dd.MM.yyyy" Style="width: 100%;"/>
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="@nameof(ShowReceiptResponse.totalAmount)" Title="Kwota" Frozen="true" Width="25%">
            <Template Context="data">
                @(data.totalAmount)zł
            </Template>
            <EditTemplate Context="receipt">
                -
            </EditTemplate>
        </RadzenDataGridColumn>
    </Columns>
</RadzenDataGrid>

<style>
    .button {
        width: 36px;
        height: 36px;
    }
</style>