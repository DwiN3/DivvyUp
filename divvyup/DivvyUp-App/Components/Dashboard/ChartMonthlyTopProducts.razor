@using System.Globalization
@using DivvyUp_Shared.Dtos.Entity
@using DivvyUp_Shared.Interfaces

<RadzenStack Style="width: 100%; height: 100%;" AlignItems="AlignItems.Start" JustifyContent="JustifyContent.Start">
    <RadzenChart Style="min-height: 100%; width: 100%;">
        <RadzenColumnSeries Data="@MonthlyTopProductList" Title="Koszt produktu" CategoryProperty="@nameof(ChartDto.Name)" ValueProperty="@nameof(ChartDto.Value)" />
        <RadzenValueAxis Formatter="@Format">
            <RadzenGridLines Visible="true" />
            <RadzenLegend Visible="false" />
            <RadzenColumnOptions Radius="5" />
            @* <RadzenAxisTitle Text="Największe wydatki w miesiącu" /> *@
        </RadzenValueAxis>
    </RadzenChart>
</RadzenStack>

@code {
    [Inject]
    private IChartService ChartService { get; set; }

    [Parameter]
    public EventCallback OnLoadComplete { get; set; }

    private List<ChartDto> MonthlyTopProductList { get; set; }

    protected override async Task OnInitializedAsync()
    {
        MonthlyTopProductList = await ChartService.GetMonthlyTopProducts();
        await OnLoadComplete.InvokeAsync();
    }

    string Format(object value)
    {
        return ((double)value).ToString("C0", CultureInfo.CreateSpecificCulture("pl-PL"));
    }
}
